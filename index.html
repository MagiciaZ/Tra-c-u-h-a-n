<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tra c·ª©u h√≥a ƒë∆°n</title>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 20px;
}

.container {
    max-width: 800px;
    margin: 40px auto;
    background: white;
    border-radius: 16px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
    overflow: hidden;
}

.header {
    background: linear-gradient(135deg, #0066cc 0%, #0052a3 100%);
    color: white;
    padding: 30px;
    text-align: center;
}

h1 {
    font-size: 28px;
    font-weight: 600;
    margin-bottom: 15px;
}

.invoice-code {
    font-size: 20px;
    font-weight: 600;
    background: rgba(255, 255, 255, 0.2);
    padding: 12px 20px;
    border-radius: 8px;
    display: inline-block;
}

.content {
    padding: 30px;
}

.info-section {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 25px;
}

.info-row {
    display: flex;
    padding: 10px 0;
    border-bottom: 1px solid #e0e0e0;
}

.info-row:last-child {
    border-bottom: none;
}

.info-label {
    font-weight: 600;
    color: #555;
    width: 120px;
}

.info-value {
    color: #333;
    flex: 1;
}

.section-title {
    font-size: 18px;
    font-weight: 600;
    color: #333;
    margin: 25px 0 15px 0;
    padding-bottom: 10px;
    border-bottom: 2px solid #0066cc;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    border-radius: 8px;
    overflow: hidden;
}

table th {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 14px 10px;
    text-align: center;
    font-weight: 600;
    font-size: 14px;
}

table td {
    padding: 14px 10px;
    text-align: center;
    border-bottom: 1px solid #e0e0e0;
    color: #333;
}

table tbody tr:hover {
    background-color: #f5f7ff;
}

table tbody tr:last-child td {
    border-bottom: none;
}

.money-cell {
    text-align: center;  
    font-weight: 500;
    color: #0066cc;
}

.total-section {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 20px;
    border-radius: 10px;
    margin-top: 25px;
    text-align: right;
}

.total-label {
    font-size: 16px;
    margin-bottom: 8px;
}

.total-amount {
    font-size: 28px;
    font-weight: 700;
}

.loading, .error {
    text-align: center;
    padding: 60px 20px;
    font-size: 16px;
}

.loading {
    color: #666;
}

.error {
    color: #cc0000;
}

.footer-note {
    text-align: center;
    color: #888;
    font-size: 13px;
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid #e0e0e0;
}

@media (max-width: 600px) {
    .container {
        margin: 20px auto;
    }
    
    h1 {
        font-size: 22px;
    }
    
    .invoice-code {
        font-size: 16px;
    }
    
    table {
        font-size: 13px;
    }
    
    table th, table td {
        padding: 10px 6px;
    }
}
</style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>üè• Tra c·ª©u h√≥a ƒë∆°n nh√† thu·ªëc</h1>
        <div class="invoice-code" id="invoice-code-display">ƒêang t·∫£i...</div>
    </div>
    
    <div class="content" id="content">
        <p class="loading">‚è≥ ƒêang t·∫£i d·ªØ li·ªáu...</p>
    </div>
</div>

<script>
const urlParams = new URLSearchParams(window.location.search);
const code = urlParams.get("code");

if (!code) {
    document.getElementById("content").innerHTML =
        '<p class="error">‚ùå Kh√¥ng t√¨m th·∫•y m√£ h√≥a ƒë∆°n trong URL.</p>';
    document.getElementById("invoice-code-display").textContent = "Kh√¥ng c√≥ m√£";
} else {
    document.getElementById("invoice-code-display").textContent = `M√£: ${code}`;
    
    const jsonUrl = `./invoices/${code}.json`;
    
    fetch(jsonUrl)
        .then(res => {
            if (!res.ok) {
                throw new Error(`HTTP error! status: ${res.status}`);
            }
            return res.json();
        })
        .then(data => {
            let itemsHTML = '';
            if (data.items && data.items.length > 0) {
                itemsHTML = `
                    <div class="section-title">üì¶ Chi ti·∫øt s·∫£n ph·∫©m</div>
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 8%;">STT</th>
                                <th style="width: 32%;">T√™n thu·ªëc</th>
                                <th style="width: 16%;">H·∫°n Thu·ªëc</th>
                                <th style="width: 10%;">SL</th>
                                <th style="width: 17%;">ƒê∆°n gi√°</th>
                                <th style="width: 17%;">T·ªïng</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                data.items.forEach((item, index) => {
                    itemsHTML += `
                        <tr>
                            <td>${index + 1}</td>
                            <td><strong>${item.name}</strong></td>
                            <td>${item.expiry || 'N/A'}</td>
                            <td><strong>${item.quantity}</strong></td>
                            <td style="text-align: center;">${item.price.toLocaleString('vi-VN')} ƒë</td>
                            <td style="text-align: center;"><strong>${item.total.toLocaleString('vi-VN')} ƒë</strong></td>
                        </tr>
                    `;
                });
                
                itemsHTML += `
                        </tbody>
                    </table>
                `;
            }

            document.getElementById("content").innerHTML = `
                <div class="info-section">
                    <div class="info-row">
                        <div class="info-label">üìÖ Ng√†y:</div>
                        <div class="info-value">${data.date}</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">‚è∞ Gi·ªù:</div>
                        <div class="info-value">${data.time}</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">üë§ Kh√°ch h√†ng:</div>
                        <div class="info-value">${data.customer || 'Kh√°ch l·∫ª'}</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">‚öïÔ∏è B√°c sƒ© k√™ ƒë∆°n:</div>
                        <div class="info-value">${data.doctor || 'N/A'}</div>
                    </div>
                        <div class="info-row">
                        <div class="info-label">üë®‚Äç‚öïÔ∏è NV b√°n h√†ng:</div>
                        <div class="info-value">${data.staff || 'N/A'}</div>
                    </div>
                </div>
                
                ${itemsHTML}
                
                <div class="total-section">
                    <div class="total-label">üí∞ T·ªïng c·ªông</div>
                    <div class="total-amount">${data.total.toLocaleString('vi-VN')} ƒë</div>
                </div>
                
                <div class="footer-note">
                     C·∫£m ∆°n qu√Ω kh√°ch ƒë√£ tin t∆∞·ªüng s·ª≠ d·ª•ng d·ªãch v·ª• c·ªßa ch√∫ng t√¥i!
                </div>
            `;
        })
        .catch(err => {
            console.error('Error:', err);
            document.getElementById("content").innerHTML =
                `<p class="error">‚ùå Kh√¥ng t√¨m th·∫•y h√≥a ƒë∆°n v·ªõi m√£: <strong>${code}</strong></p>
                <p style="text-align: center; color: #666; font-size: 14px; margin-top: 15px;">Vui l√≤ng ki·ªÉm tra l·∫°i m√£ h√≥a ƒë∆°n.</p>`;
        });
}
</script>
</body>
</html>
